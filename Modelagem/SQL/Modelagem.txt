DROP DATABASE IF EXISTS PRESENCA_TERRA_DE_ISMAEL;
CREATE DATABASE PRESENCA_TERRA_DE_ISMAEL;
USE PRESENCA_TERRA_DE_ISMAEL;
DROP TABLE IF EXISTS PESSOA;
CREATE TABLE PESSOA(
ID_PES INT NOT NULL AUTO_INCREMENT,
NOM_PES VARCHAR(255) NOT NULL,
DAT_NAS_PES DATE,
SOB_PES VARCHAR(255) NOT NULL,
TIP_PES ENUM("EVANGELIZANDO","EVANGELIZADOR","AUXILIAR"),
ATV_PES TINYINT(1) DEFAULT 1,
CONSTRAINT PRIMARY KEY PK_PESSOA(ID_PES)
);
DROP TABLE IF EXISTS FOTO;
CREATE TABLE FOTO(
ID_FOT INT NOT NULL AUTO_INCREMENT,
CAM_FOT VARCHAR(255) NOT NULL,
ID_PES INT NOT NULL,
CONSTRAINT PK_FOTO PRIMARY KEY PK_FOTO(ID_FOT),
CONSTRAINT FK_FOTO_PESSOA FOREIGN KEY (ID_PES) REFERENCES PESSOA(ID_PES)
);
DROP TABLE IF EXISTS TURMA;
CREATE TABLE TURMA(
ID_TUR INT NOT NULL AUTO_INCREMENT,
NOM_TUR VARCHAR(255),
HOR_FUN_TUR DATETIME NOT NULL,
DIA_SEM_TUR INT NOT NULL,
CONSTRAINT PK_TURMA PRIMARY KEY (ID_TUR)
);
DROP TABLE IF EXISTS PESSOA_TURMA;
CREATE TABLE PESSOA_TURMA(
ID_TUR INT NOT NULL,
ID_PES INT NOT NULL,
CONSTRAINT PK_PESSOA_TURMA PRIMARY KEY (ID_TUR, ID_PES),
CONSTRAINT FK_PESSOA_TURMA_TURMA FOREIGN KEY (ID_TUR) REFERENCES TURMA(ID_TUR),
CONSTRAINT FK_PESSOA_TURMA_PESSOA FOREIGN KEY (ID_PES) REFERENCES PESSOA(ID_PES)
);
DROP TABLE IF EXISTS PRESENCA;
CREATE TABLE PRESENCA(
ID_PRE INT NOT NULL AUTO_INCREMENT,
DAT_PRE DATE NOT NULL,
ATV_PRE TINYINT(1) DEFAULT 1,
CONSTRAINT PK_PRESENCA PRIMARY KEY (ID_PRE)
);
DROP TABLE IF EXISTS PRESENCA_PESSOA_TURMA;
CREATE TABLE PRESENCA_PESSOA_TURMA(
ID_PES INT NOT NULL,
ID_TUR INT NOT NULL,
ID_PRE INT NOT NULL,
PRE_PPT TINYINT(1) DEFAULT 0,
CONSTRAINT PK_PRESENCA_PESSOA_TURMA PRIMARY KEY (ID_TUR, ID_PES, ID_PRE),
CONSTRAINT FK_PRESENCA_PESSOA_TURMA_TURMA FOREIGN KEY (ID_TUR) REFERENCES TURMA(ID_TUR),
CONSTRAINT FK_PRESENCA_PESSOA_TURMA_PESSOA FOREIGN KEY (ID_PES) REFERENCES PESSOA(ID_PES),
CONSTRAINT FK_PRESENCA_PESSOA_TURMA_PRESENCA FOREIGN KEY (ID_PRE) REFERENCES PRESENCA(ID_PRE)
);

